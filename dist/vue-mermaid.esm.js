function _defineProperty(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _slicedToArray(n,e){return _arrayWithHoles(n)||_iterableToArrayLimit(n,e)||_unsupportedIterableToArray(n,e)||_nonIterableRest()}function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_unsupportedIterableToArray(n)||_nonIterableSpread()}function _arrayWithoutHoles(n){if(Array.isArray(n))return _arrayLikeToArray(n)}function _arrayWithHoles(n){if(Array.isArray(n))return n}function _iterableToArray(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}function _iterableToArrayLimit(n,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n)){var t=[],r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done)&&(t.push(a.value),!e||t.length!==e);r=!0);}catch(n){i=!0,o=n}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return t}}function _unsupportedIterableToArray(n,e){if(n){if("string"==typeof n)return _arrayLikeToArray(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(n,e):void 0}}function _arrayLikeToArray(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function normalizeComponent(n,e,t,r,i,o,a,s,c,d){"boolean"!=typeof a&&(c=s,s=a,a=!1);var u="function"==typeof t?t.options:t;n&&n.render&&(u.render=n.render,u.staticRenderFns=n.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),r&&(u._scopeId=r);var l;if(o?(l=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),e&&e.call(this,c(n)),n&&n._registeredComponents&&n._registeredComponents.add(o)},u._ssrRegister=l):e&&(l=a?function(){e.call(this,d(this.$root.$options.shadowRoot))}:function(n){e.call(this,s(n))}),l)if(u.functional){var f=u.render;u.render=function(n,e){return l.call(e),f(n,e)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,l):[l]}return t}function createInjector(n){return function(n,e){return addStyle(n,e)}}function addStyle(n,e){var t=isOldIE?e.media||"default":n,r=styles[t]||(styles[t]={ids:new Set,styles:[]});if(!r.ids.has(n)){r.ids.add(n);var i=e.source;if(e.map&&(i+="\n/*# sourceURL="+e.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),r.element||(r.element=document.createElement("style"),r.element.type="text/css",e.media&&r.element.setAttribute("media",e.media),HEAD.appendChild(r.element)),"styleSheet"in r.element)r.styles.push(i),r.element.styleSheet.cssText=r.styles.filter(Boolean).join("\n");else{var o=r.ids.size-1,a=document.createTextNode(i),s=r.element.childNodes;s[o]&&r.element.removeChild(s[o]),s.length?r.element.insertBefore(a,s[o]):r.element.appendChild(a)}}}function install(n){n.component("vue-mermaid",VueMermaid)}import mermaid from"mermaid";var script={name:"VueMermaid",props:{type:{type:String,default:"graph TD"},nodes:{type:Array,required:!0},styles:{type:Array,default:function(){return[]}},config:{type:Object,default:function(){return{}}},defaultConfig:{type:Object,default:function(){return{theme:"default",startOnLoad:!1,securityLevel:"loose"}}},stopOnError:{type:Boolean,default:!1}},data:function(){return{edges:[{type:"default",open:"[",close:"]"},{type:"round",open:"(",close:")"},{type:"circle",open:"((",close:"))"},{type:"asymetric",open:">",close:"]"},{type:"rhombus",open:"{",close:"}"}]}},mounted:function(){this.init(),this.loadNodes()},computed:{nodeObject:function(){var n=this.nodes;if(Array.isArray(n)&&n.length>0){return function(n,e){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(n.map(function(n){return _defineProperty({},n[e],n)}))))}(n,"id")}return{}},customStyle:function(){var n=this.nodes,e=this.styles,t=n.filter(function(n){return n.style}).map(function(n){return"style ".concat(n.id," ").concat(n.style)}),r=n.filter(function(n){return n.linkStyle}).map(function(e){return"linkStyle ".concat(e.linkNumber||n.indexOf(e)," ").concat(e.linkStyle)});return t.concat(e).concat(r)},parseCode:function(){var n=this.nodes;if(Array.isArray(n)&&n.length>0){var e=this.type+"\n",t=e+this.getGroupNodes(n)+this.customStyle.join(" \n");return this.load(t),console.log(t),t}return""}},methods:{getGroupNodes:function(n){var e=this,t=new Map;return n.forEach(function(n){var e=n.group||"",r=t.get(e)||{nids:new Set,narr:[]};r.nids.add(n.id),r.narr.push(n),t.set(e,r)}),_toConsumableArray(t.entries()).map(function(n){var t=_slicedToArray(n,2),r=t[0],i=t[1],o=i.nids,a=i.narr;if(""!==r){var s=[],c=[];a.forEach(function(n){n.next?(s.push({id:n.id,text:n.text,style:n.style}),n.next.forEach(function(e){o.has(e)?s.push({id:n.id,text:n.text,link:n.link,next:[e]}):c.push({id:n.id,text:n.text,link:n.link,next:[e]})})):s.push(n)});var d=e.buildNodesStr(s),u=e.buildNodesStr(c);return"subgraph ".concat(r," \n ").concat(d," end \n ").concat(u)}return e.buildNodesStr(a)}).join(" \n")},buildNodesStr:function(n){var e=this;return n.map(function(n){return n.next&&n.next.length>0?n.next.map(function(t,r){var i=e.nodeObject[t]||e.nodeObject[t.id];return null!=i&&void 0!==i?"".concat(e.buildNode(n)).concat(e.buildLink(n,r)).concat(e.buildNode(i)):"".concat(e.buildNode(n))}).join("\n"):"".concat(e.buildNode(n))}).join("\n")+"\n"+n.filter(function(n){return n.editable}).map(function(n){return"click ".concat(n.id," mermaidClick")}).join("\n")+"\n"+n.filter(function(n){return n.url}).map(function(n){return"click ".concat(n.id,' "').concat(n.url,'"')}).join("\n")+"\n"},buildNode:function(n){var e=n.edgeType?this.edges.find(function(e){return e.type===n.edgeType}):this.edges.find(function(n){return"default"===n.type});return"".concat(n.id).concat(e.open).concat(n.text).concat(e.close)},buildLink:function(n,e){return n.link?Array.isArray(n.link)?n.link.length>e?n.link[e]:n.link[n.link.length-1]:n.link:"--\x3e"},loadNodes:function(){this.load(this.parseCode)},init:function(){var n=this;window.mermaidClick=function(e){n.edit(e)},mermaid.initialize(Object.assign(this.defaultConfig,this.config))},load:function(n){if(n){var e=document.getElementById("mermaid");if(e){e.removeAttribute("data-processed"),e.replaceChild(document.createTextNode(n),e.firstChild);try{mermaid.init(n,e)}catch(n){if(this.stopOnError)throw n}}}},edit:function(n){this.$emit("nodeClick",n)}}},normalizeComponent_1=normalizeComponent,isOldIE="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase()),HEAD=document.head||document.getElementsByTagName("head")[0],styles={},browser=createInjector;const __vue_script__=script;var __vue_render__=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"mermaid",attrs:{id:"mermaid"}},[n._v(n._s(n.parseCode))])},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;const __vue_inject_styles__=function(n){n&&n("data-v-c574217a_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",map:{version:3,sources:[],names:[],mappings:"",file:"vue-mermaid.vue"},media:void 0})},__vue_scope_id__=void 0,__vue_module_identifier__=void 0,__vue_is_functional_template__=!1;var VueMermaid=normalizeComponent_1({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,void 0,!1,void 0,browser,void 0),index={install:install};export default index;
